$(document).ready(function () { $("a").each(function () { var e = $(this).attr("href") || ""; if (null != e) { e = e.toLowerCase() } e.lastIndexOf("."), e.lastIndexOf("/"); var t = !!e.match(/^https?\:\/\//), a = -1; if ("#" === e) return !0; a = Math.max(a, e.indexOf(window.location.hostname.toLowerCase())), (t && -1 === a || !t || 0 === e.indexOf("javascript:")) && $(this).click(function () { var t = ""; if (null != $(this).attr("title")) t = $(this).attr("title").replace(/[\[\]\(\)<>]/gi, ""); else { var a = $(this).html().replace(/(<([^>]+)>)/gi, "").replace(/\s/gi, ""); "" != a && (a.length > 10 && (a = a.substring(0, 10)), t = a.substring(0, 10)) } console.log($(this).html().replace(/(<([^>]+)>)/gi, "").replace(/\s/gi, "")), console.log($(this)), 0 === e.indexOf("javascript:") && (e = ""); var i = "https://api.www.gov.tw/Common/OutSiteClick.ashx?s=" + getParameterByName("s") + "&sms=" + getParameterByName("sms") + "&n=" + getParameterByName("n") + "&site=" + CCMS_SitesSN_Encryption + "&LinkSource=" + encodeURI(t).replace(/#/, "") + "&link=" + encodeURI(e); console.log(encodeURI(i)), $.ajax({ url: encodeURI(i), type: "POST" }) }) }) });