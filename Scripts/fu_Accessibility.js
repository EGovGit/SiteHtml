$(window).load(function () { var t, e, a, r, n, s; if (0 < $("table").length) { var h = $("table"); for (i = 0; i < h.length; i++)if (null == h.eq(i).attr("id") && h.eq(i).attr("id", "table_" + i), 0 == (s = h.eq(i).find("th")).length) for (n = h.eq(i).find("td"), j = 0; j < n.length; j++)if (r = n.eq(j).parent().index() + 1, a = n.eq(j).index() + 1, e = 0, 1 == r) null == n.eq(j).attr("id") && n.eq(j).attr("id", "table_" + i + "_" + j); else for (k = 0; k < n.length; k++) { var d = n.eq(k).parent().index() + 1; n.eq(k).index(); if (1 == d && (e = null == n.eq(k).attr("colspan") ? Number(e) + Number(1) : Number(e) + Number(n.eq(k).attr("colspan"))), e >= a) { null == n.eq(j).attr("headers") && n.eq(j).attr("headers", n.eq(k).attr("id")); break } } else { for (null == h.eq(i).attr("id") && h.eq(i).attr("id", "table_" + i), s = h.eq(i).find("th"), j = 0; j < s.length; j++)null == s.eq(j).attr("id") && s.eq(j).attr("id", "table_" + i + "_" + j); for (n = h.eq(i).find("td"), k = 0; k < n.length; k++) { r = n.eq(k).parent().index() + 1, a = n.eq(k).index() + 1; var o = 0; for (l = e = 0; l < s.length; l++)if (t = s.eq(l).parent().index() + 1, s.eq(l).index() + 1, 1 == t && (e = null == s.eq(l).attr("colspan") ? Number(e) + Number(1) : Number(e) + Number(s.eq(l).attr("colspan"))), e >= a) { null == n.eq(k).attr("headers") && n.eq(k).attr("headers", s.eq(l).attr("id")); break } for (l = 0; l < s.length; l++)if (t = s.eq(l).parent().index() + 1, 1 == s.eq(l).index() + 1 && (o = null == s.eq(l).attr("rowspan") ? Number(o) + Number(1) : Number(o) + Number(s.eq(l).attr("rowspan"))), o >= r) { var f = n.eq(k).attr("headers"); null == f ? null == n.eq(k).attr("headers") && n.eq(k).attr("headers", s.eq(l).attr("id")) : (f = f + " " + s.eq(l).attr("id"), null == n.eq(k).attr("headers") && n.eq(k).attr("headers", f)); break } } } } var u = "[另開新視窗]", c = "[彈出視窗]"; !function () { try { switch (document.getElementsByTagName("html")[0].getAttribute("lang").toLowerCase()) { case "zh-hant-tw": 1, u = "[另開新視窗]", c = "[彈出視窗]"; break; case "en": 2, u = "[open a new window]", c = "[open a inline window]"; break; case "vi": 2, u = "[Mở cửa sổ mới]", c = "[Cửa sổ bật lên]"; break; case "id": 2, u = "[Buka jendela baru]", c = "[Jendela pop-up]"; break; case "th": 2, u = "[เปิดหน้าต่างใหม่]", c = "[ออกจากหน้าต่าง]"; break; case "jp": 2, u = "[新しいウィンドウを開きます]", c = "[ポップアップウィンドウ]"; break; case "ko": 2, u = "[새창 열기]", c = "[인라인 창을 엽니 다]"; break; default: 2, u = "[open a new window]", c = "[open a inline window]" } } catch (t) { 1 } }(); var q = $("title").html().trim(); function m(t) { var e = "0"; t && (e = t / 16); var a = Math.pow(10, 4); return e = Math.round(e * a) / a, e += "em" } if (null != q && "" != q && 0 != q.length || (q = "標題項目"), $("img:not([alt])").each(function (t) { $(this).attr("alt", q + "_" + t) }), $("img[alt='null'], img[alt='Null'], img[alt='NULL'] , img[alt=' ']").each(function (t) { $(this).attr("alt", "") }), $("[data-fancyboxopen]").each(function (t) { var e = $(this).attr("title"); $(this).attr("title", c + e) }), $("a").each(function (t) { "" == $(this).text() && 0 == $(this).children().length && $(this).append('<p style="display:none">‌</p>'); var e = $(this).attr("title"), a = ""; null != e && 0 != e.length || ($(this).children().length > 0 ? ("" == (a = $(this).text()) && (a = q + "_" + t), "" == a && (a = " ")) : a = 0 == $(this).children().length && "" != $(this).text() ? $(this).text() : q + "_" + t, "" == a.trim() && null != $(this).attr("name") && (a = $(this).attr("name")), $(this).attr("title", a)); var i, l, r = window.location.origin.toLowerCase(); null != $(this).attr("href") && $(this).attr("href").indexOf("http") > -1 && -1 == $(this).attr("href").indexOf(r) && -1 == $(this).attr("href").indexOf("webws.miaoli.gov.tw") && "#" != $(this).attr("href") && "_blank" != $(this).attr("target") && $(this).attr("href").indexOf("javascript:") < 0 && $(this).attr("target", "_blank"), "_blank" == $(this).attr("target") && -1 == (i = $(this).attr("title"), -1 != (l = i.indexOf("視窗")) ? l : -1 != (l = i.indexOf("分頁")) ? l : -1 != (l = i.indexOf("另開")) ? l : -1 != (l = i.indexOf("新窗")) ? l : -1 != (l = i.indexOf("new window")) ? l : l = i.indexOf("window")) && $(this).attr("title", u + $(this).attr("title")), (null != $(this).find("img") && $(this).children().length > 1 || "" != $(this).text()) && $(this).find("img").attr("alt", "") }), $("a[onkeypress]").each(function (t) { $(this).removeAttr("onkeypress") }), $(".btn-tool.btn-problem").each(function (t) { $(this).attr("style", "display:none") }), $(".base-mobile .search .in .hd .in h4").remove(), $("iframe").each(function (t) { var e = "影音"; "" != $('div[class="photoandtext"] h4').html() && (e = $('div[class="photoandtext"] h4').html()), null == $(this).attr("title") && $(this).attr("title", e), null == $(this).attr("title") && null == e && null != $(this).attr("data-src") && $(this).attr("data-src").indexOf("youtu") > -1 && $(this).attr("title", "youtube"), null == $(this).attr("title") && null == e && null != $(this).attr("data-src") && $(this).attr("data-src").indexOf("Frame_PublicHearing") > -1 && $(this).attr("title", "公聽會"), null == $(this).attr("title") && null == e && null != $(this).attr("data-src") && $(this).attr("data-src").indexOf("Frame_LiveVideo") > -1 && $(this).attr("title", "議會直播"), null == $(this).attr("title") && null == e && null != $(this).attr("data-src") && $(this).attr("data-src").indexOf("IframeDetail") > -1 && $(this).attr("title", "本會專刊"), null == $(this).attr("title") && null == e && $(this).attr("title", "Map") }), 0 < $("span").length) { var p = $("span"); for (i = 0; i < p.length; i++) { if (null != p.eq(i).attr("style") && -1 != p.eq(i).attr("style").indexOf("font-size") && -1 != p.eq(i).css("font-size").toLowerCase().indexOf("px")) "0" != (g = m(p.eq(i).css("font-size").toLowerCase().replace("px", ""))) && p.eq(i).css("font-size", g) } } if (0 < $("p").length) { var b = $("p"); for (i = 0; i < b.length; i++) { var g; if (null != b.eq(i).attr("style") && -1 != b.eq(i).attr("style").indexOf("font-size") && -1 != b.eq(i).css("font-size").toLowerCase().indexOf("px")) "0" != (g = m(b.eq(i).css("font-size").toLowerCase().replace("px", ""))) && b.eq(i).css("font-size", g) } } "1" == CCMS_LanguageSN && ($(".small").find("a").attr("title", $(".small").find("a").attr("title") + "字級"), $(".medium").find("a").attr("title", $(".medium").find("a").attr("title") + "字級"), $(".large").find("a").attr("title", $(".large").find("a").attr("title") + "字級"), $(".share").find("ul").find("a").each(function () { $(this).attr("title", $(this).attr("title").replace(/\Share to/g, "分享至")) })) });